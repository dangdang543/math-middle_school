<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>순환소수 마스터: 통합 완결편</title>
    <style>
        body { font-family: 'Pretendard', sans-serif; background-color: #f8f9fa; display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; }
        .container { background: white; padding: 1.5rem; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); width: 95%; max-width: 600px; text-align: center; }
        h1 { color: #1a73e8; font-size: 1.4rem; margin-bottom: 1rem; }
        .info-table { width: 100%; border-collapse: collapse; margin-bottom: 1.5rem; font-size: 0.72rem; text-align: left; }
        .info-table th, .info-table td { border: 1px solid #eee; padding: 6px; }
        .info-table th { background: #e8f0fe; color: #1967d2; }
        
        .equation-box { background: #fffde7; padding: 15px; border-radius: 12px; margin: 10px 0; font-size: 2.2rem; font-weight: bold; color: #d93025; }
        .step-guide { font-size: 0.9rem; color: #444; margin-bottom: 10px; background: #f1f3f4; padding: 12px; border-radius: 8px; text-align: left; line-height: 1.5; }
        
        .input-area { display: flex; justify-content: center; align-items: center; gap: 5px; margin: 1rem 0; font-size: 1.4rem; }
        input { width: 220px; padding: 12px; border: 2px solid #1a73e8; border-radius: 8px; text-align: center; font-size: 1.2rem; outline: none; }
        
        .btn-main { width: 100%; padding: 15px; background: #1a73e8; color: white; border: none; border-radius: 8px; cursor: pointer; font-size: 1.1rem; font-weight: bold; }
        .btn-next { background: #34a853; margin-top: 10px; }
        .hint-box { font-size: 0.85rem; color: #d93025; margin-top: 15px; padding: 12px; background: #fce8e6; border-radius: 8px; display: none; text-align: left; }
        .hidden { display: none; }
    </style>
</head>
<body>

<div class="container">
    <div id="screen-info">
        <h1>분수에서 순환소수로: 통합 가이드</h1>
        <p style="font-size: 0.8rem; color: #666;">아래의 인수분해 표를 참고하여 문제를 해결하세요.</p>
        <table class="info-table">
            <tr><th>99...9</th><th>인수분해 결과 (핵심 요소)</th></tr>
            <tr><td>99</td><td>9 × <b>11</b></td></tr>
            <tr><td>999</td><td>27 × <b>37</b></td></tr>
            <tr><td>9,999</td><td>9 × 11 × <b>101</b></td></tr>
            <tr><td>99,999</td><td>9 × <b>41</b> × 271</td></tr>
            <tr><td>999,999</td><td>7 × 11 × 13 × 37 × 27</td></tr>
            <tr><td>9,999,999</td><td>9 × <b>239</b> × <b>4649</b></td></tr>
            <tr><td>99,999,999</td><td>9 × 11 × <b>73</b> × 101 × <b>137</b></td></tr>
        </table>
        <button class="btn-main" onclick="startQuiz()">연습 시작하기 (Enter)</button>
    </div>

    <div id="screen-quiz" class="hidden">
        <div id="question-step" class="step-guide"></div>
        <div class="equation-box" id="display-question"></div>
        <div class="input-area">
            <span>0.</span>
            <input type="tel" id="user-input" placeholder="순환마디 입력" autocomplete="off">
            <span>...</span>
        </div>
        <button class="btn-main" id="check-btn" onclick="checkAnswer()">정답 확인</button>
        <button class="btn-main btn-next hidden" id="next-btn" onclick="nextQuestion()">다음 문제</button>
        <div id="hint-box" class="hint-box"></div>
    </div>
</div>

<script>
    let currentProblem = {};
    const problems = [
        // 기초 (2~3자리)
        { q: "4/11", step: "분모를 99로 만드세요.<br>11 × 9 = 99 입니다.", ans: "36", hint: "4/11 = 36/99 = 0.3636..." },
        { q: "2/37", step: "분모를 999로 만드세요.<br>37 × 27 = 999 입니다.", ans: "054", hint: "2 × 27 = 54. 3자리를 위해 054." },
        // 중급 (4~5자리)
        { q: "3/101", step: "분모를 9,999로 만드세요.<br>101 × 99 = 9,999 입니다.", ans: "0297", hint: "3 × 99 = 297. 4자리를 위해 0297." },
        { q: "1/41", step: "분모를 99,999로 만드세요.<br>41 × 2439 = 99,999 입니다.", ans: "02439", hint: "1/41 = 2439/99999 = 0.02439..." },
        // 심화 (6자리)
        { q: "5/13", step: "1/13 = 076923 임을 이용하세요.<br>분자 5를 곱해 6자리 마디를 구하세요.", ans: "384615", hint: "76923 × 5 = 384615." },
        // 초심화 (7~8자리)
        { q: "1/239", step: "분모를 9,999,999로 만드세요.<br>239 × 41841 = 9,999,999 입니다.", ans: "0041841", hint: "7자리이므로 0041841." },
        { q: "2/73", step: "분모를 99,999,999로 만드세요.<br>73 × 1,369,863 = 99,999,999 입니다.", ans: "02739726", hint: "1,369,863 × 2 = 2,739,726. 8자리를 위해 앞에 0." }
    ];

    function startQuiz() {
        document.getElementById('screen-info').classList.add('hidden');
        document.getElementById('screen-quiz').classList.remove('hidden');
        nextQuestion();
    }

    function nextQuestion() {
        currentProblem = problems[Math.floor(Math.random() * problems.length)];
        document.getElementById('display-question').innerText = currentProblem.q;
        document.getElementById('question-step').innerHTML = currentProblem.step;
        document.getElementById('user-input').value = '';
        document.getElementById('hint-box').style.display = 'none';
        document.getElementById('next-btn').classList.add('hidden');
        document.getElementById('check-btn').classList.remove('hidden');
        document.getElementById('user-input').focus();
    }

    function checkAnswer() {
        const val = document.getElementById('user-input').value.trim();
        if (val === currentProblem.ans) {
            alert("정답입니다! 훌륭해요.");
            nextQuestion();
        } else {
            const hb = document.getElementById('hint-box');
            hb.innerHTML = `<strong>오답입니다!</strong> 정답은 <b>${currentProblem.ans}</b><br>${currentProblem.hint}`;
            hb.style.display = 'block';
            document.getElementById('check-btn').classList.add('hidden');
            document.getElementById('next-btn').classList.remove('hidden');
        }
    }

    window.addEventListener('keydown', (e) => {
        if (e.key === 'Enter') {
            if (!document.getElementById('screen-info').classList.contains('hidden')) startQuiz();
            else if (!document.getElementById('next-btn').classList.contains('hidden')) nextQuestion();
            else checkAnswer();
        }
    });
</script>
</body>
</html>